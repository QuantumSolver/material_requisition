var _=(r,e,c)=>new Promise((h,o)=>{var l=s=>{try{x(c.next(s))}catch(d){o(d)}},p=s=>{try{x(c.throw(s))}catch(d){o(d)}},x=s=>s.done?h(s.value):Promise.resolve(s.value).then(l,p);x((c=c.apply(r,e)).next())});import{_ as f,e as i,f as t,t as n,i as u,r as b,h as g,n as v,F as y,j as m,o as a}from"./index-CjRPw6xi.js";import{E as w,A as k}from"./external-link-BxT4Ot0t.js";const R={name:"ReceiptDetail",components:{ArrowLeft:k,ExternalLink:w},props:{id:{type:String,required:!0}},data(){return{isLoading:!1,receipt:null}},computed:{receiptId(){return this.id}},mounted(){this.loadReceipt()},methods:{loadReceipt(){return _(this,null,function*(){this.isLoading=!0;try{const r=yield fetch("/api/method/material_requisition.api.purchase_receipt.get_receipt_detail",{method:"POST",headers:{"Content-Type":"application/json","X-Frappe-CSRF-Token":window.csrf_token||""},body:JSON.stringify({receipt_name:this.receiptId})});if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);const e=yield r.json();if(e.exc)throw new Error(e.exc);this.receipt=e.message}catch(r){console.error("Failed to load receipt:",r),this.receipt=null}finally{this.isLoading=!1}})},goBack(){this.$router.go(-1)},openInERPNext(){const r=`/app/purchase-receipt/${this.receiptId}`;window.open(r,"_blank")},viewMaterialRequest(r){this.$router.push(`/request/${r}`)},openMRInERPNext(r){const e=`/app/material-request/${r}`;window.open(e,"_blank")},openPOInERPNext(r){const e=`/app/purchase-order/${r}`;window.open(e,"_blank")},formatDate(r){return new Date(r).toLocaleDateString()},formatCurrency(r){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(r||0)},getStatusLabel(r){return{0:"Draft",1:"Submitted",2:"Cancelled"}[r]||"Unknown"},getStatusBadgeClass(r){return{0:"bg-gray-100 text-gray-800",1:"bg-green-100 text-green-800",2:"bg-red-100 text-red-800"}[r]||"bg-gray-100 text-gray-800"}}},C={class:"min-h-screen bg-gradient-to-br from-blue-50 to-purple-50 p-6"},E={class:"max-w-7xl mx-auto"},P={class:"flex items-center justify-between mb-8"},I={class:"text-4xl font-bold text-gray-800 mb-2"},L={class:"flex space-x-3"},N={key:0,class:"text-center py-12"},S={key:1,class:"space-y-6"},q={class:"bg-white rounded-xl shadow-lg p-6"},B={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},D={class:"text-lg font-medium text-gray-800"},O={class:"text-lg font-medium text-gray-800"},T={class:"text-lg font-medium text-gray-800"},j={class:"text-lg font-medium text-gray-800"},F={class:"text-lg font-medium text-gray-800"},M={key:0,class:"mt-4"},A={class:"text-gray-800"},U={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},V={key:0,class:"bg-white rounded-xl shadow-lg p-6"},G={class:"space-y-2"},z={class:"font-medium text-gray-800"},H={class:"flex space-x-2"},J=["onClick"],Q=["onClick"],W={key:1,class:"bg-white rounded-xl shadow-lg p-6"},X={class:"space-y-2"},K={class:"font-medium text-gray-800"},Y={class:"text-sm text-gray-600"},Z={class:"flex space-x-2"},$=["onClick"],tt={class:"bg-white rounded-xl shadow-lg p-6"},et={class:"overflow-x-auto"},st={class:"min-w-full"},rt={class:"py-3 px-4"},ot={class:"font-medium text-gray-800"},nt={class:"text-sm text-gray-600"},lt={class:"py-3 px-4 text-gray-600"},it={class:"py-3 px-4 text-right text-gray-800"},at={class:"py-3 px-4 text-right"},dt={class:"font-medium text-green-600"},ct={class:"py-3 px-4 text-gray-600"},pt={class:"py-3 px-4 text-right text-gray-800"},xt={class:"py-3 px-4 text-right text-gray-800"},ut={class:"py-3 px-4 text-gray-600"},gt={key:2,class:"text-center py-16"};function yt(r,e,c,h,o,l){const p=b("ExternalLink"),x=b("ArrowLeft");return a(),i("div",C,[t("div",E,[t("div",P,[t("div",null,[t("h1",I,"📦 "+n(l.receiptId),1),e[3]||(e[3]=t("p",{class:"text-lg text-gray-600"},"Purchase Receipt Details",-1))]),t("div",L,[t("button",{onClick:e[0]||(e[0]=(...s)=>l.openInERPNext&&l.openInERPNext(...s)),class:"bg-blue-500 hover:bg-blue-600 text-white px-6 py-3 rounded-lg flex items-center space-x-2 transition-colors"},[u(p,{class:"w-5 h-5"}),e[4]||(e[4]=t("span",null,"Open in ERPNext",-1))]),t("button",{onClick:e[1]||(e[1]=(...s)=>l.goBack&&l.goBack(...s)),class:"bg-gray-500 hover:bg-gray-600 text-white px-6 py-3 rounded-lg flex items-center space-x-2 transition-colors"},[u(x,{class:"w-5 h-5"}),e[5]||(e[5]=t("span",null,"Back",-1))])])]),o.isLoading?(a(),i("div",N,e[6]||(e[6]=[t("div",{class:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"},null,-1),t("p",{class:"mt-4 text-gray-600"},"Loading receipt details...",-1)]))):o.receipt?(a(),i("div",S,[t("div",q,[e[14]||(e[14]=t("h2",{class:"text-2xl font-bold text-gray-800 mb-4"},"Receipt Information",-1)),t("div",B,[t("div",null,[e[7]||(e[7]=t("p",{class:"text-sm text-gray-600"},"Supplier",-1)),t("p",D,n(o.receipt.supplier),1)]),t("div",null,[e[8]||(e[8]=t("p",{class:"text-sm text-gray-600"},"Posting Date",-1)),t("p",O,n(l.formatDate(o.receipt.posting_date)),1)]),t("div",null,[e[9]||(e[9]=t("p",{class:"text-sm text-gray-600"},"Status",-1)),t("span",{class:v([l.getStatusBadgeClass(o.receipt.docstatus),"px-3 py-1 rounded-full text-sm font-bold"])},n(l.getStatusLabel(o.receipt.docstatus)),3)]),t("div",null,[e[10]||(e[10]=t("p",{class:"text-sm text-gray-600"},"Grand Total",-1)),t("p",T,n(l.formatCurrency(o.receipt.grand_total)),1)]),t("div",null,[e[11]||(e[11]=t("p",{class:"text-sm text-gray-600"},"Company",-1)),t("p",j,n(o.receipt.company),1)]),t("div",null,[e[12]||(e[12]=t("p",{class:"text-sm text-gray-600"},"Created By",-1)),t("p",F,n(o.receipt.owner),1)])]),o.receipt.remarks?(a(),i("div",M,[e[13]||(e[13]=t("p",{class:"text-sm text-gray-600"},"Remarks",-1)),t("p",A,n(o.receipt.remarks),1)])):g("",!0)]),t("div",U,[o.receipt.material_requests&&o.receipt.material_requests.length>0?(a(),i("div",V,[e[15]||(e[15]=t("h3",{class:"text-xl font-bold text-gray-800 mb-4"},"📋 Related Material Requests",-1)),t("div",G,[(a(!0),i(y,null,m(o.receipt.material_requests,s=>(a(),i("div",{key:s,class:"flex items-center justify-between p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors"},[t("span",z,n(s),1),t("div",H,[t("button",{onClick:d=>l.viewMaterialRequest(s),class:"text-blue-500 hover:text-blue-600 text-sm"}," View ",8,J),t("button",{onClick:d=>l.openMRInERPNext(s),class:"text-blue-500 hover:text-blue-700 transition-colors",title:"Open in ERPNext"},[u(p,{class:"w-3 h-3"})],8,Q)])]))),128))])])):g("",!0),o.receipt.purchase_orders&&o.receipt.purchase_orders.length>0?(a(),i("div",W,[e[16]||(e[16]=t("h3",{class:"text-xl font-bold text-gray-800 mb-4"},"🛒 Related Purchase Orders",-1)),t("div",X,[(a(!0),i(y,null,m(o.receipt.purchase_orders,s=>(a(),i("div",{key:s.purchase_order,class:"flex items-center justify-between p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors"},[t("div",null,[t("p",K,n(s.purchase_order),1),t("p",Y,n(s.supplier),1)]),t("div",Z,[t("button",{onClick:d=>l.openPOInERPNext(s.purchase_order),class:"text-blue-500 hover:text-blue-700 transition-colors",title:"Open in ERPNext"},[u(p,{class:"w-3 h-3"})],8,$)])]))),128))])])):g("",!0)]),t("div",tt,[e[18]||(e[18]=t("h3",{class:"text-xl font-bold text-gray-800 mb-4"},"📦 Items Received",-1)),t("div",et,[t("table",st,[e[17]||(e[17]=t("thead",null,[t("tr",{class:"border-b border-gray-200"},[t("th",{class:"text-left py-3 px-4 font-medium text-gray-700"},"Item"),t("th",{class:"text-left py-3 px-4 font-medium text-gray-700"},"Description"),t("th",{class:"text-right py-3 px-4 font-medium text-gray-700"},"Qty"),t("th",{class:"text-right py-3 px-4 font-medium text-gray-700"},"Received"),t("th",{class:"text-left py-3 px-4 font-medium text-gray-700"},"UOM"),t("th",{class:"text-right py-3 px-4 font-medium text-gray-700"},"Rate"),t("th",{class:"text-right py-3 px-4 font-medium text-gray-700"},"Amount"),t("th",{class:"text-left py-3 px-4 font-medium text-gray-700"},"Warehouse")])],-1)),t("tbody",null,[(a(!0),i(y,null,m(o.receipt.items,s=>(a(),i("tr",{key:s.item_code,class:"border-b border-gray-100 hover:bg-gray-50"},[t("td",rt,[t("div",null,[t("p",ot,n(s.item_code),1),t("p",nt,n(s.item_name),1)])]),t("td",lt,n(s.description),1),t("td",it,n(s.qty),1),t("td",at,[t("span",dt,n(s.received_qty),1)]),t("td",ct,n(s.uom),1),t("td",pt,n(l.formatCurrency(s.rate)),1),t("td",xt,n(l.formatCurrency(s.amount)),1),t("td",ut,n(s.warehouse),1)]))),128))])])])])])):(a(),i("div",gt,[e[19]||(e[19]=t("div",{class:"text-6xl mb-4"},"❌",-1)),e[20]||(e[20]=t("h3",{class:"text-xl font-bold text-gray-800 mb-2"},"Receipt not found",-1)),e[21]||(e[21]=t("p",{class:"text-gray-600 mb-6"},"The requested purchase receipt could not be loaded.",-1)),t("button",{onClick:e[2]||(e[2]=(...s)=>l.goBack&&l.goBack(...s)),class:"bg-blue-500 hover:bg-blue-600 text-white px-6 py-3 rounded-lg font-medium transition-colors"}," Go Back ")]))])])}const bt=f(R,[["render",yt]]);export{bt as default};
